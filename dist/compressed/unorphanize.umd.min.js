!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.unorphanizeLink=i():t.unorphanizeLink=i()}(window,function(){return function(t){var i={};function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=1)}([function(t,i,e){"use strict";function n(t){return t.substring(0,t.search(/\S/))}function o(t){return t.search(/\s+$/)>-1?t.substring(t.search(/\s+$/),t.length):""}Object.defineProperty(i,"__esModule",{value:!0}),i.getLeadingSpace=n,i.getTrailingSpace=o,i.wrapString=function(t,i){return"\n    <"+i.wrapEl+' class="'+i.className+'">\n      '+t+i.append+"\n    </"+i.wrapEl+">"},i.wrapPlainTextWords=function(t,i){var e=t.trim().split(" ");if(e.length<i.wordCount)return t;var r=e.splice(e.length-i.wordCount,i.wordCount),s=n(t)+e.join(" "),h=r.join(" ")+o(t);return s+"\n    <"+i.wrapEl+' class="'+i.className+'">\n      '+h+i.append+"\n    </"+i.wrapEl+">"}},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),o=e(0),r=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=i;try{this.origText=this.el.textContent,this.childNodes=this.el.children}catch(t){throw Error("Unorphanize: Constructor requires a DOM node object")}0===i.innerHTML.trim().length&&console.warn("Unorphanize: Element contains no text or child nodes"),this.options=Object.assign({},{wordCount:2,wrapEl:"span",className:"u-nowrap",append:""},e),this.options.wordCount=parseInt(this.options.wordCount,10),isNaN(this.options.wordCount)&&(this.options.wordCount=2),this.options.append.length&&(this.options.wordCount-=1),0===this.childNodes.length?this.el.innerHTML=(0,o.wrapPlainTextWords)(this.origText,this.options):this.wrapRichText()}return n(t,[{key:"updateChildNodeVars",value:function(){this.childHtml=this.childEl.outerHTML,this.currentChildSplit=this.el.innerHTML.split(this.childHtml),this.textBeforeChild=this.currentChildSplit[0],this.textAfterChild=this.currentChildSplit[1]||"",this.markupIndex=this.textAfterChild.indexOf("<"),this.plainText=this.markupIndex>-1?this.textAfterChild.substring(0,this.markupIndex):this.textAfterChild,this.previousString=this.markupIndex>-1?this.textAfterChild.substring(this.markupIndex):"",this.childText=this.childEl.textContent,this.childWordCount=this.childText.length?this.childText.trim().split(" ").length:1,this.plainTextWords=this.plainText.trim().length?this.plainText.trim().split(" "):null,this.plainTextWordCount=null!==this.plainTextWords?this.plainTextWords.length:0,this.partialWord="",this.plainTextWordCount>0&&0===this.plainText.search(/\S/)&&(this.partialWord=this.plainTextWords.shift(),this.plainTextWordCount--)}},{key:"formatTextBeforeFirstChild",value:function(){var t=this.el.innerHTML,i=t.indexOf("<");this.textBeforeChild=i>-1?t.substring(0,i):t;var e=i>-1?t.substring(i):"";if(this.textBeforeChild.trim().length>0){var n=this.textBeforeChild.trim().split(" ");if(n.length+this.previousWordCount===this.options.wordCount)return this.el.classList.add(this.options.className),!0;if(n.length+this.previousWordCount>=this.options.wordCount){var r=this.options.wordCount-this.previousWordCount,s=(0,o.getLeadingSpace)(this.textBeforeChild)+n.splice(0,n.length-r).join(" "),h=n.join(" ")+(0,o.getTrailingSpace)(this.textBeforeChild);return this.el.innerHTML=s+(0,o.wrapString)(h+e,this.options),!0}}}},{key:"wrapRichText",value:function(){this.previousWordCount=0;for(var t=this.childNodes.length;t>0;t--)if(this.childEl=this.childNodes[t-1],this.updateChildNodeVars(),0===this.plainTextWordCount)if(this.childWordCount+this.previousWordCount>=this.options.wordCount){if(0===this.previousWordCount)return this.childText.length?this.childEl.innerHTML=(0,o.wrapPlainTextWords)(this.childEl.textContent,this.options):this.childEl.outerHTML=(0,o.wrapString)(this.childEl.outerHTML,this.options),!0;if(this.childWordCount+this.previousWordCount===this.options.wordCount)return this.el.innerHTML=this.textBeforeChild+(0,o.wrapString)(this.childHtml+this.textAfterChild,this.options),!0;if(this.childWordCount+this.previousWordCount>this.options.wordCount)return console.warn("Unorphanize: Can’t safely prevent orphans on this element \n",this.el),!0}else this.previousWordCount+=this.childWordCount;else{if(this.plainTextWordCount+this.previousWordCount===this.options.wordCount)return this.el.innerHTML=this.textBeforeChild+this.childHtml+(0,o.wrapString)(this.plainText+this.previousString,this.options),!0;if(this.plainTextWordCount+this.previousWordCount>this.options.wordCount){var i=this.options.wordCount-this.previousWordCount,e=(0,o.getLeadingSpace)(this.plainText)+this.plainTextWords.splice(0,this.plainTextWordCount-i).join(" "),n=this.plainTextWords.join(" ")+(0,o.getTrailingSpace)(this.plainText);return this.el.innerHTML=this.textBeforeChild+this.childHtml+e+(0,o.wrapString)(n+this.previousString,this.options),!0}if(this.childWordCount+this.plainTextWordCount+this.previousWordCount===this.options.wordCount)return this.el.innerHTML=this.textBeforeChild+(0,o.wrapString)(this.childHtml+this.plainText+this.previousString,this.options),!0;if(this.childWordCount+this.plainTextWordCount+this.previousWordCount>this.options.wordCount)return console.warn("Unorphanize: Can’t safely prevent orphans on this element \n",this.el),!0;this.previousWordCount+=this.childWordCount+this.plainTextWordCount}this.formatTextBeforeFirstChild()}}]),t}();i.default=r}])});